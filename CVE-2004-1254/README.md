# CVE-2004-1254

- CVSS 2.0: `10.0`
- Vulnerability Type: `BOF`
- Software: `WinRAR`
- Affacted Versions:
    - 3.0.0
    - 3.10
    - 3.11
    - 3.20
    - 3.40
    - 3.41
- Version Tested: `3.40`
- Links:
    - [Software](https://www.exploit-db.com/exploits/694)
    - [POC](https://www.exploit-db.com/exploits/694)

## Video

[![](https://img.youtube.com/vi/IZhPTAmlsqk/0.jpg)](https://www.youtube.com/watch?v=IZhPTAmlsqk)

## Steps

1. Install WinRAR 3.40
2. On the other machine, if it is Linux based, install `gcc-mingw-w64` for cross compiling
3. On the other machine, run `x86_64-w64-mingw32-gcc 694.c` to generate Windows executable file `a.exe`. If our machine is Windows based, just using `gcc` to compile it.
4. Send the executable file to victim machine (whether using website, ssh, or the others)
5. execute `a.exe` file to generate `vulnerable_zip.zip`
6. Open `vulnerable_zip.zip` and delete the wierd file inside

The WinRAR.exe will crash now!!!