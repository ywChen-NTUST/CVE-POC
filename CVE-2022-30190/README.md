# CVE-2022-30190

- Alias: `Follina`
- CVSS 3.x: `7.8`
- Vulnerability Type: `BOF`
- Software: `Microsoft Windows Support Diagnostic Tool (MSDT)`
- Affacted Versions:
    - Windows 7
    - Windows 8.1
    - Windows 10
    - Windows 11
    - Windows Server 2008
    - Windows Server 2012
    - Windows Server 2016
    - Windows Server 2019
    - Windows Server 2022

- Version Tested: `Windows Server 2022`
- Links:
    - [POC](https://github.com/JohnHammond/msdt-follina)
    - [Analysis](https://billdemirkapi.me/unpacking-cve-2021-40444-microsoft-office-rce/)

## Video

[![](https://img.youtube.com/vi/UZ2zbdKkHoQ/0.jpg)](https://www.youtube.com/watch?v=UZ2zbdKkHoQ)

## Steps

1. Install Microsoft Office with arbitrary version (had tested on [`2013 Professional Plus`](https://archive.org/details/microsoft-office-professional-plus-2013), `2016 Professional Plus`)
    - During installation, in the "first in first" step, choose "Ask me later"
2. On the other machine, run `python3 follina.py -c <command>` or `python3 follina.py -r <rshell_port>` to generate POC file `follina.doc`
3. Send the POC file to victim machine (whether using website, ssh, or the others)
4. Double click the `follina.doc` and enable edit mode
    - If it shows "Content within this application coming from the website listed below is being blocked ...", click `Add` button and add the host to the trust zone

The RCE will take effect now!!!