# CVE-2021-44790

- CVSS 3.x: `9.8`
- Vulnerability Type: `BOF`
- Software: `Apache HTTP Server`
- Affacted Versions:
    - <= 2.4.51
- Version Tested: `2.4.38`
- Links:
    - [Software](https://www.apachelounge.com/download/VC11/)
    - [POC](https://www.youtube.com/watch?v=530j-QrGjOo)
    - [POC2](https://www.exploit-db.com/exploits/51193)

## Video

[![](https://img.youtube.com/vi/rEvnHjHiyoc/0.jpg)](https://www.youtube.com/watch?v=rEvnHjHiyoc)

## Steps

1. Unpack `httpd-2.4.38-win64-VC11.zip` and install [Visual C++ Redistributable for Visual Studio 2012](https://www.microsoft.com/en-us/download/details.aspx?id=30679)
2. Copy `test.lua` into `Apache24\htdocs`
3. Modify `Apache24\conf\httpd.conf` with below options
    - Line 37: Set `Define SRVROOT '<Unpacked Path>/Apache24'`
    - Line 137: Uncomment `LoadModule lua_module modules/mod_lua.so`
    - Line 432: Add `AddHandler lua-script .lua`
4. Execute `./Apache24/bin/httpd.exe` to start Apache server
5. Disable Windows filewall in order to export server in LAN
6. On the other machine, execute command in `command.sh`

The Apache deamon will crash now and automatic start a process with different pid!!!