# CVE-2023-43131

- CVSS 3.x: `7.8`
- Vulnerability Type: `Heap BOF`
- Software: `Diagon`
- Affacted Versions:
    - 1.0.139
- Version Tested: `1.0.139`
- Links:
    - [Software](https://github.com/ArthurSonzogni/Diagon/releases/download/v1.0.139/diagon-1.0.139-win64.zip)
    - [POC](https://talosintelligence.com/vulnerability_reports/TALOS-2023-1744)

## Video

[![](https://img.youtube.com/vi/UrgRuW7tLwk/0.jpg)](https://www.youtube.com/watch?v=UrgRuW7tLwk)

## Steps

1. Unzip and extract Diagon 1.0.139
2. Copy VC_redist debug relative dlls and `ucrtbased.dll` in the same directory of `diagon.exe`
    - `ucertbase.dll` can be found in `C:\Windows\System32` if windows SDK installed. Or you can use [mine](./ucrtbased.dll)
    - The other dlls can be found in `<visual studio path>\Community\VC\Redist\MSVC\<vcredist version>\debug_nonredist\x64\Microsoft.VC143.DebugCRT` or you can use [mine](./Microsoft.VC143.DebugCRT.zip)
3. Run `.\diagon.exe Sequence` and paste the content of `poc.md`
    - Remember to press ctrl-Z for EOF

The diagon.exe will crash now!!!