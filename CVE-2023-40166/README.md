# CVE-2023-40166

- Alias: `GHSL-2023-092`
- CVSS 3.x: `5.5`
- Vulnerability Type: `Heap BOF`
- Software: `Notepad++`
- Affacted Versions:
    - <= 8.5.6
- Version Tested: `8.5.6`
- Links:
    - [Software](https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.5.6/npp.8.5.6.portable.x64.zip)
    - [POC](https://securitylab.github.com/advisories/GHSL-2023-092_Notepad__/)

## Video

[![](https://img.youtube.com/vi/KIkAMGEbFAo/0.jpg)](https://www.youtube.com/watch?v=KIkAMGEbFAo)

## Steps

1. Install [Windows SDK](https://developer.microsoft.com/zh-tw/windows/downloads/windows-sdk/) (for Gflags, which can enable page heap and detect OOB heap write) and unzip Notepad++ 8.5.6
2. Open gflags.exe. Choose `Image file` tab and input `notepad++.exe`. Enable the `Enable page heap` checkbox
3. On the other machine, run `python3 poc.py` to generate POC file `poc.xml`
4. Send the POC file to victim machine (whether using website, ssh, or the others)
5. Execute Notepad++ and open `poc.xml`

The notepad++.exe will encounter error code 0xc0000005, which is usually diplayed as an address violation!!!